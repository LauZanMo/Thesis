# 1 绪论

## 1.1 研究背景

​		四旋翼飞行器，是一种可以垂直起降，自由悬停的飞行器，因其拥有四个呈十字形交叉的螺旋桨的紧凑结构而得名，其相对于固定翼飞机有着起飞场地更加自由且能够悬停的优势，因此，四旋翼飞行器能够在军用或民用领域完成复杂的室内场景任务。

​		室外飞行器定位主要依赖GPS，GPS的搜星数量是飞行器定位的重要指标，但是，针对无GPS的室内环境下，飞行器则需要使用其他传感器进行定位与导航，同时，室内飞行器的体积与功耗也对算法的复杂程度有所限制，因此，如何在有限的体积与功耗的情况下，使用合适的传感器，提升飞行器的室内定位精度与鲁棒性，是飞行器室内定位的关键。

## 1.2 研究现状

​		国内外关于飞行器室内定位导航方案较多，以下列出几种应用于室内的解决方案：

​		超宽带定位导航。又称为UWB，其使用纳秒级非正弦波窄脉冲传输数据，有很高的时间分辨率，因此被运用到室内定位中，目前大部分室内定位产品运用的是Decawave推出的DW1000芯片，有集成度高，价格低廉的优点，但是，UWB也有信号容易被阻隔，需要提前布置的缺点，在地质勘探等高危场景下并不适用。

​		视觉定位导航。目前主流视觉SLAM前端方法有特征点法，光流法，直接法，后端方法有滤波器法和图优化法，相较于其他两种方法，特征点法有精度高的优点，但是需要对整张图像进行特征点提取，对算力要求更大，其他两种方法精度稍低，但是胜在速度更快，更适合算力较低的计算平台。图优化法相较于滤波器法精度更高，但是对于地图较大的场景维护速度会下降，滤波器法因为只需要考虑最近的数据，所以速度更快，但是会存在累积误差。目前优秀的视觉SLAM算法有ORB-SLAM，VINS，DSO等。

​		雷达定位导航。目前主流雷达定位方法主要是激光雷达和毫米波雷达，雷达测量精度高，在较暗环境下相较于视觉表现更好，在自动驾驶领域采用雷达方案的较多。但是，用于三维定位的雷达价格极高，且扫描频率低，不适合高速运动情况下的飞行器进行定位与导航。

​		本文旨在运用机载相机，对机载相机参数、硬件及定位导航策略进行优化，提升飞行器在无GPS情况下室内定位的精度与鲁棒性，从而运用到地质勘探，廊道巡逻等无GPS的复杂环境下。

## 1.3 主要内容与章节安排

​		本文主要的研究内容是设计一套携带鱼眼相机的飞行器SLAM系统，其中包括飞行器结构设计，鱼眼相机T265标定，针对T265在基于特征点的视觉SLAM进行参数优化和飞行器SLAM系统的整合。飞行器结构设计包括飞行器载荷计算与动力选用、飞行器机架构思与搭建；鱼眼相机T265标定包括鱼眼相机投影模型与畸变模型的选用、单目鱼眼相机的内参标定、双目鱼眼相机的外参标定；针对T265在基于特征点的视觉SLAM进行参数优化包括调整ORB提取特征点的数量、尺度因子、图像金字塔的数量以及提取Fast角点的阈值；飞行器SLAM系统的整合包括飞行器参数的调优、mavlink通信协议的构建、ROS网络的构建。

​		本文第一章介绍了室内飞行器定位的研究背景和研究现状，第二章分析了鱼眼相机误差模型和标定方法，第三章讲述了基于特征点的ORB-SLAM3视觉SLAM算法，第四章介绍了携带鱼眼相机的飞行器SLAM系统的设计与实现，第五章讲述了对设计的飞行器SLAM系统的性能进行分析，第六章则是对设计的飞行器SLAM系统进行总结，并提出对该系统的改进思路以及对未来的展望。

# 2 双目鱼眼相机误差分析及标定方法

​		鱼眼镜头，是广角镜头中的一种，其焦距小于16mm而且视场角接近或等于180°。在鱼眼镜头拥有着大视场角的优势的同时，其也有着因为光学原理所产生形变的缺点。因此，在近年火热的即时建图与定位(SLAM)研究中，运用最多的是基于针孔相机原理的标准镜头，鱼眼镜头运用并不广泛。

​		基于四旋翼飞行器的视觉SLAM难点有：飞行器相较于小车、手持等场景抖动更大，实时性要求更高，因此，鲁棒的相机位姿估计以及高实时性，是基于飞行器的视觉SLAM必须具备的特点。使用多个鱼眼相机进行刚性耦合，不仅能增加视场角，获取更加丰富的环境特征信息，还能通过相机系统的转换矩阵这一冗余信息恢复地图的尺度，增加位姿估计的鲁棒性以及特征点的持续追踪概率，进而达到飞行器视觉高精度SLAM的目标。

​		由于透视投影模型不适合鱼眼镜头，所以我们采用了一种更加灵活的径向对称的投影模型。

## 2.1 鱼眼相机模型

​		针孔相机的透视投影模型可由以下公式描述：
$$
r=f\tan\theta \tag{2.1}
$$
​		其中$\theta$是主光轴与入射光线的夹角，$r$是像面与主点的距离，$f$是镜头的焦距。鱼眼镜头则是经常被设计成符合以下的透视模型之一：
$$
r=2f\tan(\theta/2)\tag{2.2}
$$

$$
r=f\theta\tag{2.3}
$$

$$
r=2f\sin(\theta/2)\tag{2.4}
$$

$$
r=f\sin(\theta)\tag{2.5}
$$

​		上述四个模型中最常见的模型为等距投影$(2.3)$，不同的投影模型的曲线如图2.1所示，针孔相机模型与鱼眼相机模型在几何上的差异如图2.2所示。

​		然而，真实的鱼眼镜头并不完全遵从鱼眼模型，总会有加工误差或畸变，为了对所有的鱼眼相机都具有普适性，投影的一般式被设计如下：
$$
r(\theta)=k_1\theta+k_2\theta^3+k_3\theta^5+k_4\theta^7+k_5\theta^9+\cdots\tag{2.6}
$$
​		通常只需要保留前五个系数即可在有限的计算下，式$(2.6)$可以对任何不同的投影曲线有着良好的估计，针对鱼眼相机，可以则可以退化为：
$$
r(\theta)=k_1\theta+k_2\theta^3+k_3\theta^5+k_4\theta^7\tag{2.7}
$$
​		若$f$为入射光线与归一化的图像坐标之间的映射关系，则有：
$$
\left(\begin{matrix}
x\\
y
\end{matrix}\right)
=r(\theta)
\left(\begin{matrix}
\cos\varphi\\
\sin\varphi
\end{matrix}\right)
=f(\phi)
$$


# 3 基于双目鱼眼相机的视觉SLAM技术

# 4 双目SLAM飞行器的设计与实现

# 5 双目SLAM性能分析

# 6 总结与展望

# 7 参考文献

# 8 致谢

